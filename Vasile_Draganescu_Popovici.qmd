---
title: "Vasile Draganescu Popovici"
format: html
---
First is a link to my github repository:
https://github.com/bondrzr/lab-grades

# Question 1
```{r}
library(here)
library(readr)

here::i_am("lab-grades.Rproj")
courses <- read_csv(here("data", "courses.csv"))
```
# Question 2
```{r}
library(dplyr)
library(knitr)

courses |>
rename(`course name` = course, identifier = course_id, module = module,
       `number of exams` = nb_grades) |>
arrange(`course name`) |>
kable()
```
# Question 3
```{r}
students <- read_csv(here("data", "students.csv"))
```
The birth_date column of the students data frame is of class `r class(students$birth_date)`.
The sex column of the students data frame is of class `r class(students$sex)`.

# Quesiton 4
```{r}
grades <- read_delim(here("data", "grades.csv"), delim = "|", na = "$")
```
# Question 5
```{r}
library(ggplot2)

students |>
ggplot(aes(x = factor(group))) +
geom_bar() +
xlab("Group") +
ylab("Number of students") +
theme_minimal()

```
# Question 6
```{r}
students |>
ggplot(aes(x = factor(group), fill = sex)) +
geom_bar(position = "fill") +
scale_fill_manual(values = c("salmon", "steelblue")) +
theme_minimal()
```
# Question 7
```{r}
library(lubridate)

students_age <- students |>
mutate(age = time_length(today() - birth_date, unit = "year"))

students_age |>
ggplot(aes(x = age)) +
geom_histogram(binwidth = 1, fill = "cyan", color = "white") +
xlab("Age") +
ylab("Number of students") +
theme_minimal()
```
# Question 8 
```{r}
median_age <- students |>
mutate(age = time_length(today() - birth_date, unit = "year")) |>
group_by(group) |>
summarise(median_age = round(median(age)))

median_age |>
knitr::kable()
```
# Question 9
```{r}
oldest <- students |>
mutate(age = time_length(today() - birth_date, unit = "year")) |>
group_by(group) |>
slice_max(age, n = 1) |>
ungroup() |>
select(id, sex, age, group) |>
arrange(desc(age))

oldest |>
knitr::kable()
```
# Question 10
The data set contains `r grades |> dplyr::filter(!is.na(grade)) |> nrow()` grades.
# Question 11
```{r}
martial_group <- grades |>
filter(course_id == 10, !is.na(grade)) |>
inner_join(students, by = "id") |>
group_by(group) |>
summarise(mean_grade = mean(grade))

martial_group |>
ggplot(aes(x = factor(group), y = mean_grade)) +
geom_col(fill = "tomato") +
xlab("Group") +
ylab("Average grade in Martial Arts and Self-Defense") +
theme_minimal()
```
# Question 12
```{r}
grades_mod <- grades |>
inner_join(courses, by = "course_id") |>
filter(!is.na(grade))

grades_mod |>
ggplot(aes(x = grade)) +
geom_density(fill = "steelblue", alpha = 0.6) +
facet_wrap(~ module) +
xlab("Grade") +
ylab("Proportion of grades") +
theme_minimal()
```
# Question 13
```{r}
grades_per_student <- grades |>
filter(!is.na(grade)) |>
inner_join(students, by = "id") |>
count(id, group, sex, name = "n_grades")

grades_per_student |>
slice_head(n = 5) |>
knitr::kable()
```
The minimum number of grades per student is `r min(grades_per_student$n_grades)`,  
the maximum is `r max(grades_per_student$n_grades)`,  
the average is `r mean(grades_per_student$n_grades)`,  
and the median is `r median(grades_per_student$n_grades)`.

# Question 14
```{r}
grades_per_student |>
ggplot(aes(x = sex, y = n_grades)) +
geom_boxplot(fill = "magenta") +
xlab("Sex") +
ylab("Number of grades") +
theme_minimal()
```
# Question 15
```{r}
herb <- grades |>
filter(course_id == 2, !is.na(grade)) |>
inner_join(students, by = "id") |>
count(id, group, name = "n_herb_grades")

herb |>
slice_head(n = 5) |>
knitr::kable()
```
# Question 16
```{r}
herb_dist <- herb |>
count(n_herb_grades)

herb_dist |>
ggplot(aes(x = n_herb_grades, y = n)) +
geom_col(fill = "steelblue") +
scale_y_continuous(breaks = seq(0, max(herb_dist$n), by = 50)) +
xlab("Number of grades in Herbalism and Traditional Medicine") +
ylab("Number of students") +
theme_minimal()
```
# Question 17
```{r}
herb |>
ggplot(aes(x = factor(group), y = n_herb_grades)) +
geom_boxplot(fill = "brown") +
xlab("Group") +
ylab("Number of grades in Herbalism and Traditional Medicine") +
theme_minimal()
```
# Question 18
```{r}
herb <- grades |>
filter(course_id == 2, !is.na(grade)) |>
inner_join(students, by = "id") |>
count(id, group, sex, name = "n_herb_grades")

herb |>
ggplot(aes(x = factor(group), y = n_herb_grades, fill = sex)) +
geom_boxplot() +
scale_fill_manual(values = c("F" = "salmon", "M" = "steelblue")) +
xlab("Group") +
ylab("Number of grades in Herbalism and Traditional Medicine") +
theme_minimal()
```
# Question 19
```{r}
avg_per_course <- grades |>
filter(!is.na(grade)) |>
group_by(id, course_id) |>
summarise(avg_grade = mean(grade), .groups = "drop")

avg_per_course <- avg_per_course |>
inner_join(courses, by = "course_id") |>
inner_join(students, by = "id")

avg_wide <- avg_per_course |>
select(id, group, course, avg_grade) |>
tidyr::pivot_wider(
  names_from = course,
  values_from = avg_grade)

avg_wide |>
select(id, group, 3, 4) |>
slice_head(n = 5) |>
knitr::kable()
```
# Question 20
```{r}
avg_wide |>
ggplot(aes(x = `Animal Lore and Totemism`,
           y = `Herbalism and Traditional Medicine`)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "steelblue") +
xlab("Average grade in Animal Lore and Totemism") +
ylab("Average grade in Herbalism and Traditional Medicine") +
theme_minimal()
```





